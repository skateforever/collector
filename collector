#!/bin/bash
#
# collector my script for reconnaissance during
# my job as pentester or as a hobby doing bug bounty
#

collector_command_line="$0 $*"

[[ -s "${PWD}/functions/banner.sh" ]] && source "${PWD}/functions/banner.sh"
banner

collector_path=$(dirname "$0")

if [ -s "${collector_path}/collector.cfg" ]; then
    source "${collector_path}/collector.cfg"
else
    banner
    echo -e "Please ${red}make sure${reset} you have the ${yellow}collector.cfg${reset} file."
    echo -e "${yellow}You need this to set the tools parameters${reset}!"
    echo -e "You will set aquatone, gobuster, dirsearch threads and others.\n"
    exit 1
fi

# Checking if the essencial functions there are
for file in kill_collector check_binaries usage message menu check_structure check_execution \
    domains_sources files diff_recon infra vhost web_page web_data git \
    domains_recon url_recon collector_exec; do
    function="${collector_path}/functions/${file}.sh"
    if [ -s "${function}" ]; then
        source "${function}"
    else
        echo -e "Please ${red}make sure${reset} you have the ${yellow}\"${function}\"${reset} file."
        echo -e "${yellow}You need this file to execute collector${reset}!"
        exit 1
    fi
done

menu "$@"
check_execution
check_parameter_dependency_domain
collector_exec
